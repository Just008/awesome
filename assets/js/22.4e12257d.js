(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{189:function(t,n,s){"use strict";s.r(n);var a=s(0),e=Object(a.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("Nginx 以其高性能，稳定性，丰富的功能，简单的配置和低资源消耗而闻名。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),s("p",[t._v("具体的编译安装的方法可以参考官方的这篇文章 "),s("a",{attrs:{href:"http://nginx.org/en/docs/configure.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("configure"),s("OutboundLink")],1),t._v("。")]),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("三种命令语法：")]),t._v(" "),t._m(4),s("p",[t._v("或者：")]),t._v(" "),t._m(5),s("p",[t._v("有时候我们改了配置文件只是要让配置生效，这个时候不必重启，只要重新加载配置文件即可。")]),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18)])}),[function(){var t=this.$createElement,n=this._self._c||t;return n("h1",{attrs:{id:"初识-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初识-nginx"}},[this._v("#")]),this._v(" 初识 Nginx")])},function(){var t=this.$createElement,n=this._self._c||t;return n("h2",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[this._v("#")]),this._v(" 安装")])},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Ubuntu")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y nginx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译安装，编译三部曲")]),t._v("\n$ ./configure\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# configure 也可以自己配置的，当然一般情况下是不会自己添加这么多配置的")]),t._v("\n./configure "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--user"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx                          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--group"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/nginx                   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sbin-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/sbin/nginx           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--conf-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/nginx/nginx.conf     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--pid-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/nginx.pid         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--lock-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/nginx.lock       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--error-log-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/log/nginx/error.log "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--http-log-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/log/nginx/access.log "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-http_gzip_static_module        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-http_stub_status_module        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-http_ssl_module                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-pcre                           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-file-aio                       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-http_realip_module             "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--without-http_scgi_module            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--without-http_uwsgi_module           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--without-http_fastcgi_module\n")])])])},function(){var t=this.$createElement,n=this._self._c||t;return n("h2",{attrs:{id:"基本命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[this._v("#")]),this._v(" 基本命令")])},function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[this._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" /etc/init.d/nginx restart "),n("span",{pre:!0,attrs:{class:"token comment"}},[this._v("# or start, stop")]),this._v("\n")])])])},function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[this._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[this._v("service")]),this._v(" nginx restart "),n("span",{pre:!0,attrs:{class:"token comment"}},[this._v("# or start, stop")]),this._v("\n")])])])},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# quit 优雅的关闭")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# stop 快速关闭")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reopen 重新打开日志")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reload 重载配置")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" nginx -s reload "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or quit, reopen, stop")]),t._v("\n")])])])},function(){var t=this.$createElement,n=this._self._c||t;return n("p",[n("code",[this._v("sudo nginx -s quit")]),this._v(" : Nginx 会等待进程处理完当前请求后再去关闭")])},function(){var t=this.$createElement,n=this._self._c||t;return n("p",[n("code",[this._v("sudo nginx -s reload")]),this._v(" : 首先检查配置语法，如果语法无误。主线程会开辟新的线程并向旧的线程发出关闭信号。如果语法错误，则主线程回滚并继续使用旧的配置。")])},function(){var t=this.$createElement,n=this._self._c||t;return n("h2",{attrs:{id:"配置文件的简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件的简介"}},[this._v("#")]),this._v(" 配置文件的简介")])},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ul",[s("li",[s("p",[t._v("Nginx 配置的核心是定义要处理的 "),s("code",[t._v("URL")]),t._v(" 以及如何响应这些 "),s("code",[t._v("URL")]),t._v(" 请求，即定义一系列的"),s("strong",[t._v("虚拟服务 (Virtual Servers)")]),t._v(" 控制对来自特定域名或者 IP 的请求。")])]),t._v(" "),s("li",[s("p",[t._v("每一个虚拟服务定义一系列的 "),s("code",[t._v("location")]),t._v(" 控制处理特定的 "),s("code",[t._v("URI")]),t._v(" 集合。每一个 "),s("code",[t._v("location")]),t._v(" 定义了对映射到自己的请求的处理场景，可以返回一个文件或者代理此请求")])]),t._v(" "),s("li",[s("p",[t._v("Nginx 是由不同的模块组成，和这些模块由配置文件中指定的指令控制。指令分为"),s("strong",[t._v("简单指令和块指令")])])]),t._v(" "),s("li",[s("p",[t._v("一个简单指令包含**指令名称和指令参数，**以空格分隔，以分号("),s("code",[t._v(";")]),t._v(")结尾。块指令和简单指令相似，都是由 "),s("code",[t._v("{")]),t._v(" 和 "),s("code",[t._v("}")]),t._v(" 包围。如果块指令大括号中包含其他的指令，则称该指令为上下文 (如： "),s("code",[t._v("events")]),t._v(", "),s("code",[t._v("http")]),t._v(", "),s("code",[t._v("server")]),t._v(", "),s("code",[t._v("location")]),t._v(")。")])]),t._v(" "),s("li",[s("p",[t._v("配置文件中的放在上下文之外的指令默认放在主配置文件中 (类似集成主配置文件)。"),s("code",[t._v("events")]),t._v(" 和 "),s("code",[t._v("http")]),t._v(" 放置在主配置文件中，"),s("code",[t._v("server")]),t._v(" 放置在 "),s("code",[t._v("http")]),t._v(" 块指令中，"),s("code",[t._v("location")]),t._v(" 防止在 "),s("code",[t._v("server")]),t._v(" 块指令中。")])]),t._v(" "),s("li",[s("p",[t._v("配置文件的注释是 "),s("code",[t._v("#")]),t._v(" 开始。")])])])},function(){var t=this.$createElement,n=this._self._c||t;return n("p",[n("strong",[this._v("整个配置文件结构是这样的：")])])},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里是一些配置")]),t._v("\nevents "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里是一些配置")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nhttp "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里是一些配置")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这部分可能存在于/etc/nginx/conf.d/目录下")]),t._v("\n  upstream "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    root /data/up1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    location / "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 引入不同的配置文件的方式来解决多个站点配置分开的功能")]),t._v("\n  include /etc/nginx/conf.d/*.conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tinclude /etc/nginx/sites-enabled/*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmail "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里是一些配置")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,n=this._self._c||t;return n("h2",{attrs:{id:"站点配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#站点配置"}},[this._v("#")]),this._v(" 站点配置")])},function(){var t=this.$createElement,n=this._self._c||t;return n("p",[this._v("比如你现在有一个域名，要部署一个网站，那就得创建一个 "),n("code",[this._v("server")]),this._v(" 块， 那就在 "),n("code",[this._v("/etc/nginx/conf.d/")]),this._v(" 下面创建一个 "),n("code",[this._v("*.conf")]),this._v(" 文件。")])},function(){var t=this.$createElement,n=this._self._c||t;return n("p",[this._v("假设你有个域名是 "),n("code",[this._v("foo.bar.com")]),this._v(", 那么配置文件可能如下")])},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name example.org www.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    root        /data/www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    location / "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      index   index.html index.php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    location ~* "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gif"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("jpg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件缓存时间")]),t._v("\n      expires 30d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    location ~ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(".php$ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        fastcgi_pass  localhost:9000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        fastcgi_param SCRIPT_FILENAME\n                      "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$document_root")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fastcgi_script_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        include       fastcgi_params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,n=this._self._c||t;return n("p",[this._v("当用户访问 "),n("code",[this._v("http://example.org")]),this._v(" 时会执行：")])},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ul",[s("li",[t._v("读取 "),s("code",[t._v("/data/www/index.html")]),t._v("，如果读取不到就会转发到 "),s("code",[t._v("fastcgi_pass")]),t._v(" 里面的逻辑。")]),t._v(" "),s("li",[t._v("当用户访问 "),s("code",[t._v("http://example.org/about.html")]),t._v(" 就会读取 "),s("code",[t._v("/data/www/about.html")])])])}],!1,null,null,null);n.default=e.exports}}]);